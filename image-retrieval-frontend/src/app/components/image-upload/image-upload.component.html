<div class="mb-4">
  <label for="formFileMultiple" class="form-label fw-bold text-dark">
    Upload Multiple Files
  </label>

  <!-- Custom file input container -->
  <div class="input-group">
    <input
      class="form-control"
      type="file"
      id="formFileMultiple"
      multiple
      (change)="onFileSelected($event)"
      accept="image/*"
    />
    <button
      class="btn btn-outline-secondary"
      type="button"
      (click)="uploadFiles()"
      [disabled]="!selectedFiles.length || uploading"
    >
      <i class="bi bi-upload"></i> Upload
    </button>
  </div>

  <!-- Display selected files -->
  <div *ngIf="selectedFiles.length > 0" class="mt-3">
    <h5 class="small text-muted">Selected Files:</h5>
    <ul class="list-group">
      <li class="list-group-item" *ngFor="let file of selectedFiles">
        {{ file.name }} ({{ file.size / 1024 | number: "1.0-0" }} KB)
      </li>
    </ul>
  </div>

  <!-- Progress Bar for Upload -->
  <div *ngIf="uploading" class="progress mt-3">
    <div
      class="progress-bar progress-bar-striped progress-bar-animated"
      role="progressbar"
      [style.width]="uploadProgress + '%'"
      [attr.aria-valuenow]="uploadProgress"
      aria-valuemin="0"
      aria-valuemax="100"
    ></div>
  </div>

  <!-- Error or Success Message -->
  <div *ngIf="uploadError" class="alert alert-danger mt-3">
    {{ uploadError }}
  </div>
  <div *ngIf="uploadSuccess" class="alert alert-success mt-3">
    Files uploaded successfully!
  </div>

  <!-- Image Gallery Section -->
  <div *ngIf="images.length > 0" class="mt-4">
    <h5 class="small text-muted">Liste des images téléchargées :</h5>
    <div class="row">
      <div class="col-md-3" *ngFor="let image of images">
        <div class="card">
          <img
            class="card-img-top"
            [src]="'http://localhost:5000/uploads/' + image.filename"
            alt="Image Thumbnail"
          />
          <div class="card-body">
            <h6 class="card-title">{{ image.filename }}</h6>
            <p class="card-text">
              Size: {{ image.size / 1024 | number: "1.0-0" }} KB<br />
              Type: {{ image.filename.split(".").pop().toUpperCase() }}
            </p>
            <button class="btn btn-primary" (click)="downloadImage(image)">
              Télécharger
            </button>
            <!-- Checkbox for selecting images for deletion -->
            <input 
              type="checkbox" 
              [value]="image._id"
              (change)="onCheckboxChange($event)"
            />
          </div>
        </div>
      </div>
    </div>

    <!-- Button to delete selected images -->
    <button 
      class="btn btn-danger mt-3"
      (click)="deleteSelectedImages()"
      [disabled]="selectedImages.length === 0">
      Supprimer sélectionnées
    </button>
  </div>
</div>
